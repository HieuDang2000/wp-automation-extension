// WordPress Automation Script - Generated on 2025-07-23T20:05:18.571Z
// Session ID: 1753301108374
// Total Steps: 5

(function() {
    'use strict';

    let currentStep = 0;
    const actions = [
    {
        "step": 1,
        "sessionId": 1753301108374,
        "timestamp": 1753301109590,
        "url": "https://straightguygaysex.com/wp-admin/admin.php?page=amve-import-videos",
        "page": "Trang khác",
        "type": "click",
        "element": {
            "tagName": "SPAN",
            "id": null,
            "className": "filter-option pull-left",
            "text": "18 Years Old g",
            "value": null,
            "name": null,
            "type": null,
            "href": null,
            "selector": "span[data-recorder-index=\"0\"][data-parent-class=\"btn dropdown-toggle btn-default\"].filter-option.pull-left",
            "classPath": [
                {
                    "tagName": "SPAN",
                    "id": null,
                    "classNames": [
                        "filter-option",
                        "pull-left"
                    ]
                },
                {
                    "tagName": "BUTTON",
                    "id": null,
                    "classNames": [
                        "btn",
                        "dropdown-toggle",
                        "btn-default"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "btn-group",
                        "bootstrap-select",
                        "fit-width"
                    ]
                },
                {
                    "tagName": "SPAN",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-left",
                    "classNames": [
                        "pull-left"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "form-inline"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-block",
                    "classNames": [
                        "margin-bottom-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header",
                    "classNames": [
                        "col-xs-12"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found",
                    "classNames": [
                        "col-xs-12",
                        "margin-top-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "row"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "v-cloak--hidden"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "search-top",
                    "classNames": [
                        "padding-top-15"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "import-videos",
                    "classNames": [
                        "tab-pane",
                        "fade",
                        "in",
                        "active"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "tab-content"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "content-tabs"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "wp-script",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody-content",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpcontent",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpwrap",
                    "classNames": null
                }
            ],
            "dataAttributes": {
                "data-recorder-index": "0",
                "data-parent-class": "btn dropdown-toggle btn-default"
            },
            "position": {
                "x": 488.1771011352539,
                "y": 819.4705066680908,
                "width": 102.43055725097656,
                "height": 19.98263931274414
            }
        },
        "coordinates": {
            "x": 498,
            "y": 822
        },
        "bootstrapSelectAction": "toggle",
        "selectId": "cat_wp_select",
        "timeSincePrevious": 1216
    },
    {
        "step": 2,
        "sessionId": 1753301108374,
        "timestamp": 1753301110613,
        "url": "https://straightguygaysex.com/wp-admin/admin.php?page=amve-import-videos",
        "page": "Trang khác",
        "type": "click",
        "element": {
            "tagName": "STRONG",
            "id": null,
            "className": null,
            "text": "+ Add a new category",
            "value": null,
            "name": null,
            "type": null,
            "href": null,
            "selector": "strong",
            "classPath": [
                {
                    "tagName": "STRONG",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "SPAN",
                    "id": null,
                    "classNames": [
                        "text"
                    ]
                },
                {
                    "tagName": "A",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "LI",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "UL",
                    "id": null,
                    "classNames": [
                        "dropdown-menu",
                        "inner"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "dropdown-menu",
                        "open"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "btn-group",
                        "bootstrap-select",
                        "fit-width",
                        "open"
                    ]
                },
                {
                    "tagName": "SPAN",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-left",
                    "classNames": [
                        "pull-left"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "form-inline"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-block",
                    "classNames": [
                        "margin-bottom-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header",
                    "classNames": [
                        "col-xs-12"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found",
                    "classNames": [
                        "col-xs-12",
                        "margin-top-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "row"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "v-cloak--hidden"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "search-top",
                    "classNames": [
                        "padding-top-15"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "import-videos",
                    "classNames": [
                        "tab-pane",
                        "fade",
                        "in",
                        "active"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "tab-content"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "content-tabs"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "wp-script",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody-content",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpcontent",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpwrap",
                    "classNames": null
                }
            ],
            "dataAttributes": {
                "data-recorder-index": "0",
                "data-parent-class": "text"
            },
            "listIndex": 2,
            "originalIndex": 2,
            "position": {
                "x": 516.8663482666016,
                "y": 926.5799021720886,
                "width": 143.80209350585938,
                "height": 15.555556297302246
            }
        },
        "coordinates": {
            "x": 507,
            "y": 921
        },
        "bootstrapSelectAction": "select",
        "selectId": "cat_wp_select",
        "optionIndex": "2",
        "optionValue": "null",
        "optionText": "+ Add a new category",
        "timeSincePrevious": 1023
    },
    {
        "step": 3,
        "sessionId": 1753301108374,
        "timestamp": 1753301110617,
        "url": "https://straightguygaysex.com/wp-admin/admin.php?page=amve-import-videos",
        "page": "Trang khác",
        "type": "select_change",
        "element": {
            "tagName": "SELECT",
            "id": "cat_wp_select",
            "className": null,
            "text": "- Select a WordPress category -  + Add a new categ",
            "value": "+",
            "name": null,
            "type": "select-one",
            "href": null,
            "selector": "#cat_wp_select",
            "classPath": [
                {
                    "tagName": "SELECT",
                    "id": "cat_wp_select",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "btn-group",
                        "bootstrap-select",
                        "fit-width",
                        "open"
                    ]
                },
                {
                    "tagName": "SPAN",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-left",
                    "classNames": [
                        "pull-left"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "form-inline"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-block",
                    "classNames": [
                        "margin-bottom-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header",
                    "classNames": [
                        "col-xs-12"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found",
                    "classNames": [
                        "col-xs-12",
                        "margin-top-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "row"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "v-cloak--hidden"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "search-top",
                    "classNames": [
                        "padding-top-15"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "import-videos",
                    "classNames": [
                        "tab-pane",
                        "fade",
                        "in",
                        "active"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "tab-content"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "content-tabs"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "wp-script",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody-content",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpcontent",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpwrap",
                    "classNames": null
                }
            ],
            "selectedIndex": 2,
            "selectedValue": "+",
            "selectedText": "+ Add a new category",
            "position": {
                "x": 520.8854505866766,
                "y": 819.4705543518066,
                "width": 0.4861111342906952,
                "height": 34.18402862548828
            }
        },
        "selectedIndex": 2,
        "selectedValue": "+",
        "selectedText": "+ Add a new category",
        "timeSincePrevious": 4
    },
    {
        "step": 4,
        "sessionId": 1753301108374,
        "timestamp": 1753301112130,
        "url": "https://straightguygaysex.com/wp-admin/admin.php?page=amve-import-videos",
        "page": "Trang khác",
        "type": "click",
        "element": {
            "tagName": "BUTTON",
            "id": null,
            "className": "btn btn-primary",
            "text": "Add New Category",
            "value": null,
            "name": null,
            "type": "submit",
            "href": null,
            "selector": "button[data-text-content=\"Add New Category\"][data-recorder-index=\"1\"].btn.btn-primary",
            "classPath": [
                {
                    "tagName": "BUTTON",
                    "id": null,
                    "classNames": [
                        "btn",
                        "btn-primary"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "col-xs-12"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "row"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "modal-footer"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "modal-content"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "modal-dialog"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "add-wp-cat-modal",
                    "classNames": [
                        "modal",
                        "fade",
                        "in"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found",
                    "classNames": [
                        "col-xs-12",
                        "margin-top-10"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "row"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "v-cloak--hidden"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "search-top",
                    "classNames": [
                        "padding-top-15"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "import-videos",
                    "classNames": [
                        "tab-pane",
                        "fade",
                        "in",
                        "active"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "tab-content"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": null,
                    "classNames": [
                        "content-tabs"
                    ]
                },
                {
                    "tagName": "DIV",
                    "id": "wp-script",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody-content",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpbody",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpcontent",
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "wpwrap",
                    "classNames": null
                }
            ],
            "dataAttributes": {
                "data-text-content": "Add New Category",
                "data-recorder-index": "1",
                "data-parent-class": "col-xs-12"
            },
            "position": {
                "x": 867.5781478881836,
                "y": 204.21007537841797,
                "width": 141.5104217529297,
                "height": 31.961807250976562
            }
        },
        "coordinates": {
            "x": 858,
            "y": 207
        },
        "timeSincePrevious": 1513
    },
    {
        "step": 5,
        "sessionId": 1753301108374,
        "timestamp": 1753301114248,
        "url": "https://straightguygaysex.com/wp-admin/admin.php?page=amve-import-videos",
        "page": "Trang khác",
        "type": "click",
        "element": {
            "tagName": "BUTTON",
            "id": null,
            "className": "btn btn-success",
            "text": "Import 1 videos",
            "value": null,
            "name": null,
            "type": "submit",
            "href": null,
            "selector": "#videos-found-header-left > span:nth-child(3) > button",
            "classPath": [
                {
                    "tagName": "BUTTON",
                    "id": null,
                    "classNames": [
                        "btn",
                        "btn-success"
                    ]
                },
                {
                    "tagName": "SPAN",
                    "id": null,
                    "classNames": null
                },
                {
                    "tagName": "DIV",
                    "id": "videos-found-header-left",
                    "classNames": [
                        "pull-left"
                    ]
                }
            ],
            "dataAttributes": {
                "data-original-title": "Import 1 videos and save this search as a Feed. All your Feeds are displayed at the bottom of this page.",
                "data-placement": "top",
                "data-recorder-index": "0",
                "data-parent-class": "btn btn-success"
            },
            "position": {
                "x": 637.5434341430664,
                "y": 818.3681101799011,
                "width": 186.9965362548828,
                "height": 15.555556297302246
            }
        },
        "coordinates": {
            "x": 621,
            "y": 821
        },
        "timeSincePrevious": 2118
    }
];

    function executeAction(action) {
            console.log(`Executing step ${action.step}: ${action.type}`);
            
            // Special handling for step 4 (Add New Category button)
            if (action.step === 4 && action.type === 'click') {
                return new Promise((resolve) => {
                    console.log('Special handling for step 4 - Add New Category button');
                    
                    // Try the direct selector first
                    let addButton = document.querySelector("button.btn.btn-primary");
                    
                    // Check if button exists and is not disabled
                    if (!addButton || addButton.disabled || addButton.classList.contains('disabled')) {
                        console.log('Add New Category button not found or disabled, clicking Cancel button');
                        let cancelButton = document.querySelector("#add-wp-cat-modal > div > div > div.modal-footer > div > div > button.btn.btn-default");
                        if (cancelButton) {
                            cancelButton.click();
                        } else {
                            console.warn('Cancel button not found in step 4');
                        }
                    } else {
                        console.log('Found Add New Category button, clicking it');
                        addButton.click();
                    }
                    
                    setTimeout(resolve, 1000);
                });
            }
            
            // Special handling for step 5 (import button)
            if (action.step === 5 && action.type === 'click') {
                return new Promise((resolve) => {
                    console.log('Special handling for step 5 - import button');
                    
                    // Try the direct selector first
                    let importButton = document.querySelector("#videos-found-header-left > span:nth-child(3) > button");
                    
                    // Check if button exists and is not disabled
                    if (!importButton || importButton.disabled || importButton.classList.contains('disabled')) {
                        console.log('Import button not found or disabled, clicking dropdown and selecting option');
                        
                        // Click the dropdown button
                        let dropdownButton = document.querySelector("#videos-found-header-left > span:nth-child(3) > div > button");
                        if (dropdownButton) {
                            dropdownButton.click();
                            
                            // Wait a bit for dropdown to open, then click the option
                            setTimeout(() => {
                                let option = document.querySelector("#videos-found-header-left > span:nth-child(3) > div > div > ul > li:nth-child(5) > a");
                                if (option) {
                                    option.click();
                                    console.log('Clicked dropdown option');
                                } else {
                                    console.warn('Dropdown option not found');
                                }
                                setTimeout(resolve, 1000);
                            }, 500);
                            setTimeout(() => {
                                let importButton = document.querySelector("#videos-found-header-left > span:nth-child(3) > button");
                                if (importButton) {
                                    importButton.click();
                                    console.log('Clicked import button');
                                } else {
                                    console.warn('Dropdown option not found');
                                }
                                setTimeout(resolve, 1000);
                            }, 500);
                        } else {
                            console.warn('Dropdown button not found');
                            resolve();
                        }
                    } else {
                        console.log('Found import button, clicking it');
                        importButton.click();
                        setTimeout(resolve, 1000);
                    }
                });
            }
            
            switch (action.type) {
                case 'click':
                    return executeClick(action);
                case 'input_change':
                    return executeInput(action);
                case 'select_change':
                    return executeSelectChange(action);
                case 'form_submit':
                    return executeSubmit(action);
                case 'page_navigation':
                    return executeNavigation(action);
                default:
                    console.log('Skipping action:', action.type);
                    return Promise.resolve();
            }
        }
        
        function executeSelectChange(action) {
            return new Promise((resolve) => {
                const element = findElement(action.element);
                if (element) {
                    // Set the selected index
                    if (action.selectedIndex !== undefined) {
                        element.selectedIndex = action.selectedIndex;
                    } else if (action.selectedValue) {
                        // Find by value
                        for (let i = 0; i < element.options.length; i++) {
                            if (element.options[i].value === action.selectedValue) {
                                element.selectedIndex = i;
                                break;
                            }
                        }
                    } else if (action.selectedText) {
                        // Find by text
                        for (let i = 0; i < element.options.length; i++) {
                            if (element.options[i].text === action.selectedText) {
                                element.selectedIndex = i;
                                break;
                            }
                        }
                    }
                    
                    // Dispatch change event
                    element.dispatchEvent(new Event('change', { bubbles: true }));
                    console.log('Select changed:', action.element.selector);
                } else {
                    console.warn('Select element not found:', action.element.selector);
                }
                
                const delay = action.timeSincePrevious ? Math.min(action.timeSincePrevious, 1000) : 200;
                setTimeout(resolve, delay);
            });
        }
        
        function executeClick(action) {
            return new Promise((resolve) => {
                const element = findElement(action.element);
                if (element) {
                    // Log class path if available
                    if (action.element.classPath) {
                        console.log('Class path from body:');
                        action.element.classPath.reverse().forEach((item, index) => {
                            let info = item.tagName;
                            if (item.id) info += '#' + item.id;
                            if (item.classNames) info += ' (' + item.classNames.join(' ') + ')';
                            console.log(index + ': ' + info);
                        });
                    }
                    
                    // Xử lý đặc biệt cho Bootstrap Select
                    if (action.bootstrapSelectAction === 'toggle') {
                        console.log('Bootstrap Select toggle:', action.selectId);
                        const selectElement = document.getElementById(action.selectId);
                        if (selectElement) {
                            // Tìm bootstrap-select container
                            const bootstrapSelect = selectElement.closest('.bootstrap-select');
                            let bsSelect = bootstrapSelect;
                            
                            if (!bsSelect) {
                                const selectWithId = document.querySelector('.bootstrap-select select#' + action.selectId);
                                if (selectWithId) {
                                    bsSelect = selectWithId.closest('.bootstrap-select');
                                }
                            }
                            
                            if (bsSelect) {
                                const toggleButton = bsSelect.querySelector('.dropdown-toggle');
                                if (toggleButton) {
                                    toggleButton.click();
                                    console.log('Clicked dropdown toggle for select:', action.selectId);
                                }
                            } else {
                                // Fallback to direct select click
                                selectElement.click();
                            }
                        } else {
                            // Fallback to normal click
                            element.click();
                        }
                    } else if (action.bootstrapSelectAction === 'select') {
                        console.log('Bootstrap Select option:', action.optionIndex, action.optionText);
                        
                        // Tìm select element
                        const selectElement = document.getElementById(action.selectId);
                        if (selectElement) {
                            // Tìm bootstrap-select container
                            const bootstrapSelect = selectElement.closest('.bootstrap-select');
                            let bsSelect = bootstrapSelect;
                            
                            if (!bsSelect) {
                                const selectWithId = document.querySelector('.bootstrap-select select#' + action.selectId);
                                if (selectWithId) {
                                    bsSelect = selectWithId.closest('.bootstrap-select');
                                }
                            }
                            
                            if (bsSelect) {
                                // Đảm bảo dropdown đã mở
                                if (!bsSelect.classList.contains('open')) {
                                    const toggleButton = bsSelect.querySelector('.dropdown-toggle');
                                    if (toggleButton) {
                                        toggleButton.click();
                                        console.log('Opening dropdown for select:', action.selectId);
                                    }
                                }
                                
                                // Tìm và click vào option
                                setTimeout(() => {
                                    const option = bsSelect.querySelector('li[data-original-index="' + action.optionIndex + '"] a');
                                    if (option) {
                                        option.click();
                                        console.log('Selected option:', action.optionText);
                                    } else {
                                        // Tìm bằng text nếu không tìm được bằng index
                                        const options = bsSelect.querySelectorAll('.dropdown-menu li a');
                                        for (let opt of options) {
                                            if (opt.textContent.trim().includes(action.optionText)) {
                                                opt.click();
                                                console.log('Selected option by text:', action.optionText);
                                                break;
                                            }
                                        }
                                    }
                                }, 100);
                            } else {
                                // Fallback to normal select
                                if (action.optionIndex && selectElement.options[action.optionIndex]) {
                                    selectElement.selectedIndex = action.optionIndex;
                                    selectElement.dispatchEvent(new Event('change', { bubbles: true }));
                                }
                            }
                        } else {
                            // Fallback to normal click
                            element.click();
                        }
                    } else {
                        // Normal click for non-bootstrap-select elements
                        element.click();
                    }
                    
                    console.log('Clicked:', action.element.selector);
                    // Use the recorded time between actions or default to 500ms
                    const delay = action.timeSincePrevious ? Math.min(action.timeSincePrevious, 2000) : 500;
                    setTimeout(resolve, delay);
                } else {
                    console.warn('Element not found:', action.element.selector);
                    resolve();
                }
            });
        }
        
        function executeInput(action) {
            return new Promise((resolve) => {
                const element = findElement(action.element);
                if (element) {
                    element.value = action.value;
                    element.dispatchEvent(new Event('input', { bubbles: true }));
                    console.log('Input set:', action.element.selector);
                } else {
                    console.warn('Input element not found:', action.element.selector);
                }
                // Use the recorded time between actions or default to 200ms
                const delay = action.timeSincePrevious ? Math.min(action.timeSincePrevious, 1000) : 200;
                setTimeout(resolve, delay);
            });
        }
        
        function executeSubmit(action) {
            return new Promise((resolve) => {
                const form = findElement(action.form);
                if (form) {
                    form.submit();
                    console.log('Form submitted:', action.form.selector);
                    // Form submissions typically take longer
                    const delay = action.timeSincePrevious ? Math.min(action.timeSincePrevious, 3000) : 1000;
                    setTimeout(resolve, delay);
                } else {
                    console.warn('Form not found:', action.form.selector);
                    resolve();
                }
            });
        }
        
        function executeNavigation(action) {
            return new Promise((resolve) => {
                if (window.location.href !== action.newUrl) {
                    window.location.href = action.newUrl;
                    // Navigation will reload page, so this won't continue
                }
                resolve();
            });
        }
        
        function findElement(elementInfo) {
            // Try by ID first
            if (elementInfo.id) {
                const el = document.getElementById(elementInfo.id);
                if (el) return el;
            }
            
            // Try by selector
            if (elementInfo.selector) {
                // Try direct CSS selector first (for step 5 and similar cases)
                try {
                    const el = document.querySelector(elementInfo.selector);
                    if (el) {
                        console.log('Found element by direct CSS selector:', elementInfo.selector);
                        return el;
                    }
                } catch (err) {
                    console.warn('Invalid direct selector:', elementInfo.selector);
                }
                
                // Xử lý đặc biệt cho :contains selector vì querySelector không hỗ trợ
                if (elementInfo.selector.includes(':contains(')) {
                    const baseSelector = elementInfo.selector.split(':contains(')[0];
                    const textMatch = elementInfo.selector.match(/:contains("([^"]+)")/);
                    const textToMatch = textMatch ? textMatch[1] : null;
                    
                    if (baseSelector && textToMatch) {
                        try {
                            const candidates = document.querySelectorAll(baseSelector);
                            for (let el of candidates) {
                                if (el.textContent.includes(textToMatch)) {
                                    return el;
                                }
                            }
                        } catch (err) {
                            console.warn('Invalid base selector:', baseSelector);
                        }
                    }
                    return null; // Return null if we couldn't find by text
                }
                
                try {
                    const el = document.querySelector(elementInfo.selector);
                    if (el) return el;
                } catch (err) {
                    console.warn('Invalid selector:', elementInfo.selector);
                    // Try to clean up the selector by removing invalid parts
                    const cleanSelector = elementInfo.selector
                        .replace(/:contains([^)]+)/g, '') // Remove :contains()
                        .replace(/:nth-child(d+)/g, ''); // Remove :nth-child()
                    
                    try {
                        if (cleanSelector && cleanSelector !== elementInfo.selector) {
                            const el = document.querySelector(cleanSelector);
                            if (el) return el;
                        }
                    } catch (err2) {
                        console.warn('Still invalid after cleanup:', cleanSelector);
                    }
                }
            }
            
            // For specific elements like the import button in step 5
            if (elementInfo.tagName === 'BUTTON' && elementInfo.className === 'btn btn-success') {
                // Try to find import button by its class and icon
                const importButtons = document.querySelectorAll('.btn.btn-success');
                for (let btn of importButtons) {
                    if (btn.querySelector('i.fa.fa-cloud-download') || 
                        (btn.textContent && btn.textContent.trim().includes('Import'))) {
                        console.log('Found import button by class and content');
                        return btn;
                    }
                }
            }
            
            // Try by data-recorder-index
            if (elementInfo.element && elementInfo.element.dataAttributes && 
                elementInfo.element.dataAttributes['data-recorder-index'] !== undefined) {
                const parentSelector = getParentSelector(elementInfo);
                if (parentSelector) {
                    const parent = document.querySelector(parentSelector);
                    if (parent) {
                        const index = parseInt(elementInfo.element.dataAttributes['data-recorder-index']);
                        if (parent.children[index]) {
                            return parent.children[index];
                        }
                    }
                }
            }
            
            // Try by name
            if (elementInfo.name) {
                const el = document.querySelector('[name="' + elementInfo.name + '"]');
                if (el) return el;
            }
            
            // Try by text content for buttons and links
            if ((elementInfo.tagName === 'BUTTON' || elementInfo.tagName === 'A') && elementInfo.text) {
                // First try by data-text-content attribute
                const withAttr = document.querySelector(elementInfo.tagName.toLowerCase() + '[data-text-content="' + elementInfo.text.trim() + '"]');
                if (withAttr) return withAttr;
                
                // Then try by text content
                const elements = document.querySelectorAll(elementInfo.tagName.toLowerCase());
                for (let el of elements) {
                    if (el.textContent.trim() === elementInfo.text.trim()) {
                        return el;
                    }
                }
                
                // If exact match fails, try partial match
                for (let el of elements) {
                    if (el.textContent.trim().includes(elementInfo.text.trim())) {
                        return el;
                    }
                }
            }
            
            // Try to find list item by index
            if (elementInfo.tagName === 'LI' || elementInfo.originalIndex !== undefined) {
                // Try to find parent list first
                let parentList;
                if (elementInfo.parentListId) {
                    parentList = document.getElementById(elementInfo.parentListId);
                } else if (elementInfo.element && elementInfo.element.dataAttributes && 
                          elementInfo.element.dataAttributes['data-parent-id']) {
                    parentList = document.getElementById(elementInfo.element.dataAttributes['data-parent-id']);
                } else if (elementInfo.selector) {
                    // Extract parent selector
                    const parentSelector = elementInfo.selector.split(':')[0];
                    const parentElements = document.querySelectorAll(parentSelector);
                    if (parentElements.length === 1) {
                        parentList = parentElements[0].parentElement;
                    }
                }
                
                // If we found the parent list, get the item by index
                if (parentList && elementInfo.originalIndex !== undefined) {
                    if (parentList.children[elementInfo.originalIndex]) {
                        return parentList.children[elementInfo.originalIndex];
                    }
                }
                
                // Try finding by data-original-index
                if (elementInfo.originalIndex !== undefined) {
                    const el = document.querySelector('[data-original-index="' + elementInfo.originalIndex + '"]');
                    if (el) return el;
                }
            }
            
            // For select elements, try to find option by text or value
            if (elementInfo.tagName === 'SELECT' && elementInfo.selectedIndex !== undefined) {
                const select = document.querySelector(elementInfo.selector);
                if (select && select.options[elementInfo.selectedIndex]) {
                    // Select the correct option
                    select.selectedIndex = elementInfo.selectedIndex;
                    return select;
                } else if (select && elementInfo.selectedValue) {
                    // Try to find by value
                    for (let i = 0; i < select.options.length; i++) {
                        if (select.options[i].value === elementInfo.selectedValue) {
                            select.selectedIndex = i;
                            return select;
                        }
                    }
                } else if (select && elementInfo.selectedText) {
                    // Try to find by text
                    for (let i = 0; i < select.options.length; i++) {
                        if (select.options[i].text === elementInfo.selectedText) {
                            select.selectedIndex = i;
                            return select;
                        }
                    }
                }
            }
            
            // Nếu không tìm thấy, thử tìm kiếm dựa trên class và vị trí
            if (elementInfo.className) {
                const classes = elementInfo.className.split(' ').filter(c => c.trim());
                if (classes.length > 0) {
                    const classSelector = '.' + classes.join('.');
                    const elements = document.querySelectorAll(classSelector);
                    
                    // Nếu có nhiều phần tử cùng class, thử tìm theo vị trí hoặc text
                    if (elements.length > 0) {
                        if (elementInfo.coordinates) {
                            // Tìm phần tử gần nhất với tọa độ click
                            let closestEl = null;
                            let minDistance = Infinity;
                            
                            for (let el of elements) {
                                const rect = el.getBoundingClientRect();
                                const centerX = rect.left + rect.width / 2;
                                const centerY = rect.top + rect.height / 2;
                                const distance = Math.sqrt(
                                    Math.pow(centerX - elementInfo.coordinates.x, 2) + 
                                    Math.pow(centerY - elementInfo.coordinates.y, 2)
                                );
                                
                                if (distance < minDistance) {
                                    minDistance = distance;
                                    closestEl = el;
                                }
                            }
                            
                            if (closestEl) return closestEl;
                        }
                        
                        // Nếu có text, tìm phần tử có text tương tự
                        if (elementInfo.text) {
                            for (let el of elements) {
                                if (el.textContent.trim() === elementInfo.text.trim()) {
                                    return el;
                                }
                            }
                            
                            // If exact match fails, try partial match
                            for (let el of elements) {
                                if (el.textContent.trim().includes(elementInfo.text.trim())) {
                                    return el;
                                }
                            }
                        }
                        
                        // Nếu không tìm thấy, trả về phần tử đầu tiên
                        return elements[0];
                    }
                }
            }
            
            return null;
        }

        // Helper function to get parent selector
        function getParentSelector(elementInfo) {
            if (elementInfo.element && elementInfo.element.dataAttributes) {
                if (elementInfo.element.dataAttributes['data-parent-id']) {
                    return '#' + elementInfo.element.dataAttributes['data-parent-id'];
                }
                if (elementInfo.element.dataAttributes['data-parent-class']) {
                    return '.' + elementInfo.element.dataAttributes['data-parent-class'].split(' ')[0];
                }
            }
            return null;
        }

        function simulateCtrlTab() {
            console.log('Simulating Ctrl+Tab key combination');
            
            // Create keyboard events for keydown
            const ctrlDownEvent = new KeyboardEvent('keydown', {
                key: 'Control',
                code: 'ControlLeft',
                ctrlKey: true,
                bubbles: true
            });
            
            const tabDownEvent = new KeyboardEvent('keydown', {
                key: 'Tab',
                code: 'Tab',
                ctrlKey: true,
                bubbles: true
            });
            
            // Create keyboard events for keyup
            const tabUpEvent = new KeyboardEvent('keyup', {
                key: 'Tab',
                code: 'Tab',
                ctrlKey: true,
                bubbles: true
            });
            
            const ctrlUpEvent = new KeyboardEvent('keyup', {
                key: 'Control',
                code: 'ControlLeft',
                ctrlKey: false,
                bubbles: true
            });
            
            // Dispatch the events in sequence
            document.dispatchEvent(ctrlDownEvent);
            document.dispatchEvent(tabDownEvent);
            document.dispatchEvent(tabUpEvent);
            document.dispatchEvent(ctrlUpEvent);
            
            console.log('Ctrl+Tab key combination simulated');
        }
        
        async function runAutomation() {
            console.log('Starting WordPress automation...');
            
            for (let i = 0; i < actions.length; i++) {
                const action = actions[i];
                
                // Skip session markers
                if (action.type === 'session_start' || action.type === 'session_end') {
                    continue;
                }
                
                try {
                    await executeAction(action);
                    currentStep++;
                } catch (error) {
                    console.error('Error executing action:', error);
                    break;
                }
            }
            
            console.log('Automation completed!');

            // Simulate Ctrl+Tab after all steps are completed
            setTimeout(() => {
                simulateCtrlTab();
            }, 500);
        }
        
        // Auto-start after page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', runAutomation);
        } else {
            runAutomation();
        }
        
    })();

    // To use this script:
    // 1. Open WordPress Admin in your browser
    // 2. Open Developer Console (F12)
    // 3. Paste this script and press Enter
    // 4. The automation will run automatically

    // Note: This is a generated script. You may need to modify it based on your specific needs.